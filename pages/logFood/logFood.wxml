<!--pages/logFood/logFood.wxml-->
<import src="../../template/pageHeader.wxml"/>
<view class="page">
<template is="pageHeader" data="{{...title}}"/>
  <view bindtouchstart="touchStart" bindtouchend="touchEnd">

    <view class='dateBox' bindtap="switchWeek"> 
      <text style="padding-right: 150rpx;">{{leftIcon}}</text>
      {{ year }} - {{ month}} 
      <text style="padding-left: 150rpx;">{{rightIcon}}</text>
    </view>

  <view class='box1' style='width: {{ sysW * 7 }}px'>
    <block wx:for='{{ weekArr }}' wx:key='{{weekArr.id}}'>
     <view style='width: {{ sysW }}px;color=#f3f3f3;'>
        {{ item }}
      </view>
    </block>
    <block wx:for='{{ arr }}' wx:key='{{ arr.id }}'>
     <view bindtap="selectedLog" data-date="{{item}}" style='width: {{ sysW }}px;' class='{{ item == currentDate ? "dateOn" : ""}} {{font==1?item>7?"font-color":"":font==2?item<7?"font-color":"":"" }}'>
        {{ item }}
     </view>
    </block>
  </view>
</view>
  <view class="break-line"/>
</view>
<!-- <view class="dark-green"><text>饮食记录</text></view> -->
<view wx:for="{{mealtime}}" wx:for-item="item" wx:key='{{mealtime.id}}'>
    <view class="mealtime-block">

        <view class="heading-block">
          <view class="photo">
            <image mode='aspectFill' class='meal-type-img' src='{{item.picUrl}}' wx:if="{{item.picUrl.startsWith('https://')}}"></image>
            <image mode='aspectFill' class='meal-type-img' src='https://kidneyhealty.com.cn/images/item_icon.png' wx:else></image>
          </view>
          <view class="mealtime-header">{{item}}</view>
          <view class="control" data-mealtime="{{item}}" bindtap="showMealDetail" wx:if="{{!is_complete_logged}}">
            <image mode='aspectFill' class='meal-type-img' src='https://kidneyhealty.com.cn/images/plus.png'></image>   
          </view>
        </view>

        <view class="flex-column" wx:if="{{mealFoodMap[item].length>0}}"> 
            <!-- <view class="break-line"/>            -->
            <view wx:for-item="item2" wx:for="{{mealFoodMap[item]}}" class="food-list" wx:key="item2">
                {{item2}}
            </view>
        </view>
        
    </view>
</view>
<block wx:if="{{hasMealRecord}}">
<view class="bottom-control" >
    <view wx:if="{{!if_show_report}}">
      <button bindtap='switchReport' class='btn'>看看我今天吃够了吗？</button>
    </view>
    <view wx:else>
      <button bindtap='switchReport' class='btn'>收起饮食报告</button>
    </view>
    <view class="report" wx:if="{{if_show_report}}">
    		<block wx:for="{{nutritionRatio}}" wx:for-item="item" wx:key="name">
			<view class='gridTab'>
				<view class='tab-box'>
					<text class='mini-tab-header'>{{item.name}}</text>
					<text class='mini-tab-info'>{{item.value}}</text>
				</view>
			</view>
		</block>
    </view>
  
  <button wx:if="{{is_complete_logged}}" bindtap='threeDayDietReport' class='btn'>
  最新三日膳食评价</button>
  <checkbox-group bindchange="checkboxChange">
  <label class="checkbox" >
    <checkbox value="checked" checked="{{is_complete_logged}}" />这是我一天完整的饮食记录啦
  </label>
  </checkbox-group>
  <view class="remark">
  <text>* 只有被标记为完整的膳食记录才会纳入「三日膳食」计算和获得更详细的营养师评价哦！</text>
  </view>
</view>
</block>
